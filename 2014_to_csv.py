import time
start = time.time()

import csv
import pandas as pd

file_path = "./data/Nat2014us/Nat2014PublicUS.c20150514.r20151022.txt"

# f = open("./data/Nat2018us/Nat2018PublicUS.c20190509.r20190717.txt", "r")
k = open(file_path)

file = open('Nat2014us.csv', 'w', encoding='utf-8', newline='')
output = csv.writer(file)
output.writerow(['DOB_YY','DOB_MM' ,'DOB_TT', 'DOB_WK', 'BFACIL', 'F_FACILITY','BFACIL3', 'MAGE_IMPFLG', \
    'MAGE_REPFLG','MAGER','MAGER14','MAGER9','MBSTATE_REC', 'RESTATUS','MRACE31','MRACE6', 'MRACE15', 'MBRACE', \
    'MRACEIMP', 'MHISP_R', 'F_MHISP','MRACEHISP', 'MAR_P', 'DMAR', 'MAR_IMP', 'F_MAR_P', 'MEDUC', 'F_MEDUC', \
    'FAGERPT_FLG', 'FAGECOMB', 'FAGEREC11', 'FRACE31', 'FRACE6', 'FRACE15','FBRACE', 'FHISP_R', 'F_FHISP', \
    'FRACEHISP', 'FEDUC', 'F_FEDUC', 'PRIORLIVE', 'PRIORDEAD', 'PRIORTERM', 'LBO_REC', 'TBO_REC', 'ILLB_R', \
    'ILLB_R11', 'ILOP_R', 'ILOP_R11', 'ILP_R', 'ILP_R11', 'PRECARE', 'F_MPCB', 'PRECARE5', 'PREVIS', 'PREVIS_REC', \
    'F_TPCV', 'WIC', 'F_WIC', 'CIG_0', 'CIG_1','CIG_2','CIG_3', 'CIG0_R', 'CIG1_R', 'CIG2_R','CIG3_R', 'F_CIGS_0', \
    'F_CIGS_1','F_CIGS_2','F_CIGS_3','CIG_REC','F_TOBACO','M_Ht_In','F_M_HT','BMI','BMI_R','PWgt_R','F_PWGT', \
    'DWgt_R', 'F_DWGT','WTGAIN','WTGAIN_REC','F_WTGAIN','RF_PDIAB','RF_GDIAB','RF_PHYPE','RF_GHYPE','RF_EHYPE', \
    'RF_PPTERM','F_RF_PDIAB','F_RF_GDIAB','F_RF_PHYPER','F_RF_GHYPER','F_RF_ECLAMP','F_RF_PPB','RF_INFTR', \
    'RF_FEDRG','RF_ARTEC','F_RF_INF_DRG','F_RF_INF_ART','RF_CESAR','RF_CESARN','F_RF_CESAR', \
    'F_RF_NCESAR','NO_RISKS','IP_GON','IP_SYPH','IP_CHLAM','IP_HEPB','IP_HEPC','F_IP_GONOR','F_IP_SYPH', \
    'F_IP_CHLAM','F_IP_HEPATB','F_IP_HEPATC','NO_INFEC','OB_ECVS','OB_ECVF','F_OB_SUCC','F_OB_FAIL','LD_INDL', \
    'LD_AUGM','LD_STER','LD_ANTB','LD_CHOR','LD_ANES','F_LD_INDL','F_LD_AUGM','F_LD_STER','F_LD_ANTB','F_LD_CHOR', \
    'F_LD_ANES','NO_LBRDLV','ME_PRES','ME_ROUT','ME_TRIAL','F_ME_PRES','F_ME_ROUT','F_ME_TRIAL','RDMETH_REC', \
    'DMETH_REC','F_DMETH_REC','MM_MTR','MM_PLAC','MM_RUPT','MM_UHYST','MM_AICU','F_MM_MTR','F_MM_PLAC','F_MM_RUPT', \
    'F_MM_UHYST','F_MM_AICU','NO_MMORB','ATTEND','MTRAN','PAY','PAY_REC','F_PAY','F_PAY_REC','APGAR5','APGAR5R', \
    'F_APGAR5','APGAR10','APGAR10R','DPLURAL','IMP_PLUR','SETORDER_R','SEX','IMP_SEX','DLMP_MM','DLMP_YY', \
    'COMPGST_IMP','OBGEST_FLG','COMBGEST','GESTREC10','GESTREC3','LMPUSED','OEGest_Comb','OEGest_R10', \
    'OEGest_R3','DBWT','BWTR12','BWTR4','AB_AVEN1','AB_AVEN6','AB_NICU','AB_SURF','AB_ANTI','AB_SEIZ','F_AB_VENT', \
    'F_AB_VENT6','F_AB_NIUC','F_AB_SURFAC','F_AB_ANTIBIO','F_AB_SEIZ','NO_ABNORM','CA_ANEN','CA_MNSB','CA_CCHD', \
    'CA_CDH','CA_OMPH','CA_GAST','F_CA_ANEN','F_CA_MENIN','F_CA_HEART','F_CA_HERNIA','F_CA_OMPHA','F_CA_GASTRO', \
    'CA_LIMB','CA_CLEFT','CA_CLPAL','CA_DOWN','CA_DISOR','CA_HYPO','F_CA_LIMB','F_CA_CLEFTLP','F_CA_CLEFT', \
    'F_CA_DOWNS','F_CA_CHROM','F_CA_HYPOS','NO_CONGEN','ITRAN','ILIVE','BFED','F_BFED', \
    'UBFACIL','URF_DIAB','URF_CHYPER','URF_PHYPER','URF_ECLAM','UME_FORCP','UME_VAC','UOP_INDUC','ULD_BREECH','UCA_ANEN','UCA_SPINA','UCA_OMPHA','UCA_CELFTLP','UCA_HERNIA','UCA_DOWNS']) 



 
for kine in k.readlines():
    df = {}
    df['DOB_YY'] = kine[8:12]
    df['DOB_MM'] = kine[12:14]
    df['DOB_TT'] = kine[18:22]
    df['DOB_WK'] = kine[22:23]
    df['BFACIL'] = kine[31:32]
    df['F_FACILITY'] = kine[32:33]
    df['BFACIL3'] = kine[49:50]
    df['MAGE_IMPFLG'] = kine[72:73]
    df['MAGE_REPFLG'] = kine[73:74]
    df['MAGER'] = kine[74:76]
    df['MAGER14'] = kine[76:78]
    df['MAGER9'] = kine[78:79]
    df['MBSTATE_REC'] = kine[83:84]
    df['RESTATUS'] = kine[103:104]
    df['MRACE31'] = kine[104:106]
    df['MRACE6'] = kine[106:107]
    df['MRACE15'] = kine[107:109]
    df['MBRACE'] = kine[109:110]
    df['MRACEIMP'] = kine[110:111]
# df['MHISPX'] = kine[111:112] not exist
    df['MHISP_R'] = kine[114:115]
    df['F_MHISP'] = kine[115:116]
    df['MRACEHISP'] = kine[116:117]
    df['MAR_P'] = kine[118:119]
    df['DMAR'] = kine[119:120]
    df['MAR_IMP'] = kine[120:121]
    df['F_MAR_P'] = kine[122:123]
    df['MEDUC'] = kine[123:124]
    df['F_MEDUC'] = kine[125:126]
    df['FAGERPT_FLG'] = kine[141:142]
    df['FAGECOMB'] = kine[146:148]
    df['FAGEREC11'] = kine[148:150]
    df['FRACE31'] = kine[150:152]
    df['FRACE6'] = kine[152:153]
    df['FRACE15'] = kine[153:155]
    df['FBRACE'] = kine[155:156] # exists here not in 2018
# df['FHISPX'] = kine[158:159] not exist
    df['FHISP_R'] = kine[159:160]
    df['F_FHISP'] = kine[160:161]
    df['FRACEHISP'] = kine[161:162]
    df['FEDUC'] = kine[162:163]
    # df['f_FEDUC'] = kine[164:165] used small f instead of F
    df['F_FEDUC'] = kine[164:165]
    df['PRIORLIVE'] = kine[170:172]
    df['PRIORDEAD'] = kine[172:174]
    df['PRIORTERM'] = kine[174:176]
    df['LBO_REC'] = kine[178:179]
    df['TBO_REC'] = kine[181:182]
    df['ILLB_R'] = kine[197:200]
    df['ILLB_R11'] = kine[200:202]
    df['ILOP_R'] = kine[205:208]
    df['ILOP_R11'] = kine[208:210]
    df['ILP_R'] = kine[213:216]
    df['ILP_R11'] = kine[216:218]
    df['PRECARE'] = kine[223:225]
    df['F_MPCB'] = kine[225:226]
    df['PRECARE5'] = kine[226:227]
    df['PREVIS'] = kine[237:239]
    df['PREVIS_REC'] = kine[241:243]
    df['F_TPCV'] = kine[243:244]
    df['WIC'] = kine[250:251]
    df['F_WIC'] = kine[251:252]
    df['CIG_0'] = kine[252:254]
    df['CIG_1'] = kine[254:256]
    df['CIG_2'] = kine[256:258]
    df['CIG_3'] = kine[258:260]
    df['CIG0_R'] = kine[260:261]
    df['CIG1_R'] = kine[261:262]
    df['CIG2_R'] = kine[262:263]
    df['CIG3_R'] = kine[263:264]
    df['F_CIGS_0'] = kine[264:265]
    df['F_CIGS_1'] = kine[265:266]
    df['F_CIGS_2'] = kine[266:267]
    df['F_CIGS_3'] = kine[267:268]
    df['CIG_REC'] = kine[268:269]
    df['F_TOBACO'] = kine[269:270]
    df['M_Ht_In'] = kine[279:281]
    df['F_M_HT'] = kine[281:282]
    df['BMI'] = kine[282:286]
    df['BMI_R'] = kine[286:287]
    df['PWgt_R'] = kine[291:294]
    df['F_PWGT'] = kine[294:295]
    df['DWgt_R'] = kine[298:301]
    df['F_DWGT'] = kine[302:303]
    df['WTGAIN'] = kine[303:305]
    df['WTGAIN_REC'] = kine[305:306]
    df['F_WTGAIN'] = kine[306:307]
    df['RF_PDIAB'] = kine[312:313]
    df['RF_GDIAB'] = kine[313:314]
    df['RF_PHYPE'] = kine[314:315]
    df['RF_GHYPE'] = kine[315:316]
    df['RF_EHYPE'] = kine[316:317]
    df['RF_PPTERM'] = kine[317:318]
    df['F_RF_PDIAB'] = kine[318:319]
    df['F_RF_GDIAB'] = kine[319:320]
    df['F_RF_PHYPER'] = kine[320:321]
    df['F_RF_GHYPER'] = kine[321:322]
    df['F_RF_ECLAMP'] = kine[322:323]
    df['F_RF_PPB'] = kine[323:324]
    df['RF_INFTR'] = kine[324:325]
    df['RF_FEDRG'] = kine[325:326]
    df['RF_ARTEC'] = kine[326:327]
    # df['f_RF_INFT'] = kine[327:328] not exist
    df['F_RF_INF_DRG'] = kine[328:329]
    df['F_RF_INF_ART'] = kine[329:330]
    df['RF_CESAR'] = kine[330:331]
    df['RF_CESARN'] = kine[331:333]
    df['F_RF_CESAR'] = kine[334:335]
    df['F_RF_NCESAR'] = kine[335:336]
    df['NO_RISKS'] = kine[336:337]
    df['IP_GON'] = kine[342:343]
    df['IP_SYPH'] = kine[343:344]
    df['IP_CHLAM'] = kine[344:345]
    df['IP_HEPB'] = kine[345:346]
    df['IP_HEPC'] = kine[346:347]
    df['F_IP_GONOR'] = kine[347:348]
    df['F_IP_SYPH'] = kine[348:349]
    df['F_IP_CHLAM'] = kine[349:350]
    df['F_IP_HEPATB'] = kine[350:351]
    df['F_IP_HEPATC'] = kine[351:352]
    df['NO_INFEC'] = kine[352:353]
    df['OB_ECVS']  = kine[359:360]
    df['OB_ECVF'] = kine[360:361]
    df['F_OB_SUCC'] = kine[362:363]
    df['F_OB_FAIL'] = kine[363:364]
    df['LD_INDL'] = kine[382:383]
    df['LD_AUGM'] = kine[383:384]
    df['LD_STER'] = kine[384:385]
    df['LD_ANTB'] = kine[385:386]
    df['LD_CHOR'] = kine[386:387]
    df['LD_ANES'] = kine[387:388]
    df['F_LD_INDL'] = kine[388:389]
    df['F_LD_AUGM'] = kine[389:390]
    df['F_LD_STER'] = kine[390:391]
    df['F_LD_ANTB'] = kine[391:392]
    df['F_LD_CHOR'] = kine[392:393]
    df['F_LD_ANES'] = kine[393:394]
    df['NO_LBRDLV'] = kine[394:395]
    df['ME_PRES'] = kine[400:401]
    df['ME_ROUT'] = kine[401:402]
    df['ME_TRIAL'] = kine[402:403]
    df['F_ME_PRES'] = kine[403:404]
    df['F_ME_ROUT'] = kine[404:405]
    df['F_ME_TRIAL'] = kine[405:406]
    df['RDMETH_REC'] = kine[406:407]
    df['DMETH_REC'] = kine[407:408]
    df['F_DMETH_REC'] = kine[408:409]
    df['MM_MTR'] = kine[414:415]
    df['MM_PLAC'] = kine[415:416]
    df['MM_RUPT'] = kine[416:417]
    df['MM_UHYST'] = kine[417:418]
    df['MM_AICU'] = kine[418:419]
    df['F_MM_MTR'] = kine[420:421]
    df['F_MM_PLAC'] = kine[421:422]
    df['F_MM_RUPT'] = kine[422:423]
    df['F_MM_UHYST'] = kine[423:424]
    df['F_MM_AICU'] = kine[424:425]
    df['NO_MMORB'] = kine[426:427]
    df['ATTEND'] = kine[432:433]
    df['MTRAN'] = kine[433:434]
    df['PAY'] = kine[434:435]
    df['PAY_REC'] = kine[435:436]
    df['F_PAY'] = kine[436:437]
    df['F_PAY_REC'] = kine[437:438] 
    df['APGAR5'] = kine[443:445]
    df['APGAR5R'] = kine[445:446]
    df['F_APGAR5'] = kine[446:447]
    df['APGAR10'] = kine[447:449]
    df['APGAR10R'] = kine[449:450]
    df['DPLURAL'] = kine[453:454]
    df['IMP_PLUR'] = kine[455:456]
    df['SETORDER_R']  = kine[458:459]
    df['SEX'] = kine[474:475]
    df['IMP_SEX'] = kine[475:476]
    df['DLMP_MM'] = kine[476:478]
    df['DLMP_YY'] = kine[480:484]
    df['COMPGST_IMP'] =  kine[487:488]
    df['OBGEST_FLG'] =  kine[488:489]
    df['COMBGEST'] =  kine[489:491]
    df['GESTREC10'] =  kine[491:493]
    df['GESTREC3']  =  kine[493:494]
    df['LMPUSED'] =  kine[497:498]
    df['OEGest_Comb'] = kine[498:500]
    df['OEGest_R10'] = kine[500:502]
    df['OEGest_R3'] = kine[502:503]
    df['DBWT'] = kine[503:507]
    df['BWTR12'] = kine[508:510]
    df['BWTR4'] = kine[510:511]
    df['AB_AVEN1'] = kine[516:517]
    df['AB_AVEN6'] = kine[517:518]
    df['AB_NICU'] = kine[518:519]
    df['AB_SURF'] = kine[519:520]
    df['AB_ANTI'] = kine[520:521]
    df['AB_SEIZ'] = kine[521:522]
    df['F_AB_VENT'] = kine[523:524]
    df['F_AB_VENT6'] = kine[524:525]
    df['F_AB_NIUC'] = kine[525:526]
    df['F_AB_SURFAC'] = kine[526:527]
    df['F_AB_ANTIBIO'] = kine[527:528]
    df['F_AB_SEIZ'] = kine[528:529]
    df['NO_ABNORM'] = kine[530:531]
    df['CA_ANEN'] = kine[536:537]
    df['CA_MNSB'] = kine[537:538]
    df['CA_CCHD'] = kine[538:539]
    df['CA_CDH'] = kine[539:540]
    df['CA_OMPH'] = kine[540:541]
    df['CA_GAST'] = kine[541:542]
    df['F_CA_ANEN'] = kine[542:543]
    df['F_CA_MENIN'] = kine[543:544]
    df['F_CA_HEART']  = kine[544:545]
    df['F_CA_HERNIA'] = kine[545:546]
    df['F_CA_OMPHA'] = kine[546:547]
    df['F_CA_GASTRO'] = kine[547:548]
    df['CA_LIMB'] = kine[548:549]
    df['CA_CLEFT'] = kine[549:550]
    df['CA_CLPAL'] = kine[550:551]
    df['CA_DOWN'] = kine[551:552]
    df['CA_DISOR'] = kine[552:553]
    df['CA_HYPO'] = kine[553:554]
    df['F_CA_LIMB'] = kine[554:555]
    df['F_CA_CLEFTLP'] = kine[555:556]
    df['F_CA_CLEFT'] = kine[556:557]
    df['F_CA_DOWNS'] = kine[557:558]
    df['F_CA_CHROM'] = kine[558:559]
    df['F_CA_HYPOS'] = kine[559:560]
    df['NO_CONGEN'] = kine[560:561]
    df['ITRAN'] = kine[566:567]
    df['ILIVE'] = kine[567:568]
    df['BFED'] = kine[568:569]
    df['F_BFED'] = kine[569:570]

    # Below Exist Extra vs. 2018
    df['UBFACIL'] = kine[1329:1330]
    df['URF_DIAB'] = kine[1330:1331]
    df['URF_CHYPER'] = kine[1331:1332]
    df['URF_PHYPER'] = kine[1332:1333]
    df['URF_ECLAM'] = kine[1333:1334]
    df['UME_FORCP'] = kine[1334:1335]
    df['UME_VAC'] = kine[1335:1336]
    df['UOP_INDUC'] = kine[1336:1337]
    df['ULD_BREECH'] = kine[1337:1338]
    df['UCA_ANEN'] = kine[1339:1340]
    df['UCA_SPINA'] = kine[1340:1341]
    df['UCA_OMPHA'] = kine[1341:1342]
    df['UCA_CELFTLP'] = kine[1342:1343]
    df['UCA_HERNIA'] = kine[1343:1344]
    df['UCA_DOWNS'] = kine[1344:1345]
    output.writerow(df.values())

print("Done!")
print ('Execution Time: ', time.time()- start ,' Seconds')